# Log for MA
04.01.20
To do:
Get coordinates for boxes of general window of interest, STAO, NTAO and Amazon basin

Done:
General window of interest: 180 W - 3 W, 40 N - 40 S (degrees, lon lat)
	STAO/ NTAO?
	amazon basin: 10 S - 0, 70 W - 55 W
Wrote expose short for bjÃ¶rn
computed narrowed graphic for window of interest
Amazon basin first data has no values

05.01.20

precip data is complete already, but sst is separated in single files per month
download data from webpage with a function?


Done:
Get whole sst data, did it with down them all, but actually the read me contained 
	code on how to donwload alle the files

see basic-correlation.R
check if values are apparent in latest file
Write preprocessing file for sst
	-> get filenames via list.files() DONE
	-> create list with filenames DONE
	-> loop through filenames DONE
	-> create path with filename in list DONE
	-> load data DONE
	-> add each sst file data as new dimension DONE
	? -> constrain to the window we need? Here or later? -> write function ?
		if we constrain then also to_be_filled needs to get other dimensions
	-> save data TODO

Check what time frames the data is in
	-> do EDA
Compute 1 correlation
Compute time series of correlations 
Compute mean 
Check values for different time lags


14.01.21
start 09:30. plan to do 6 pomodoros so circa 3 hours

on cdo:
start cygwin 64, shell opens, cd bin, then cdo commans run
questions? how to access data outside of working directory ?

Done:
Reread some of old notes
Installed cygwin
Installed cdo
Write preprocessing file for sst
	-> constrain window we need? Here or later?
		if we constrain, then also to_be_filled needs to get other dimensions DONE solved by cdo
	-> save processed data in a new file DONE solved by cdo
	-> used mergetime *.nc


15.01.21
start 09:00 plan to do work 4 hours.

DONE:
installed cdo for R
	updated R
	updated R studio
	updated Rtools
used setreftime on test file
	-> months since 1900 (can be changes easily)


20.01.21
start 11:00 plan to work 2 hours



Notes:
so what are we doin in the first steps with the raw data?
1. use mergetime to combine the sst data DONE
2. setreftime for both files DONE maybe we dont even need this!
3. constrain time with selyear (aka selyear) should be enough
4. constrain lot/lan

DONE:
use mergetime
use setreftime
use selyear, BUT we can not save to the same file we get input from
	-> concatenate operators?
	-> save to other file
	-> maybe rename and delete old one

21.01.21

DONE:
use selyear aka select years for time filtering
use rearrange_latlon to redefine scales of lat lon
preprocess:
	create raw/sst/monthly and after mergetime raw/sst/sst-merged DONE
	inspect why mergetime "breaks" sst data DONE
	select lat lon window DONE
EDA:
	create anomalie values for each grid point DONE
	for each year and each grid point compute mean value sst DONE
	for each year and each grid point compute g_i - mean_year, f.e g_0_0 (lon,lat) - mean_1909 DONE

23.01.21

NOTES:
means ssts in paper:
for the NTAO
take all janaurars (feb, mar, etc):
for i in len(years):
	(add all i in seq(i) ) / len(i) # gives mean annual sst for one month up to a certain year

mean ssts how I understood it:
instead of each point we could take NTAO too.
for each point, each month, each year get mean
we already get monthly data so, each point,each year in january for example
compute for this point the mean of all januaries
do sst_jan_91 - sst_jan_mean_of_all_years

maybe skip this plot when we don't know which area to use now (they use the NTAO)

what to plot then?
	plot all moths and look at them?
	inspect NA's
	inspect max and min

IDEAS from rpubd post about geospatial exploratory data analysis
	local averaging all grid points over all years
	maybe see which grid points have warmed up the most over time, see time series
	autocorrelation is definitely there, right?
		autocorrelation can occur in timer but also in space
	can we explore autocorrelation together with correlation of neighboring gridpoint?
	queen based adjacency
	local Moran-Koeffizient with comparison to LOCAL mean, arithmetisches Mittel der Abweichungen von den Nachbarregionen


IDEAS fro LISA local indicators of spatial association
	spatial autocorrelation, how strong influence regions each other
	spatial non stationarity, spatial dependencies are not alike in all regions but locally different
	local moran coefficient, deviance of x_i and surrounding regions from the GLOBAL mean (different than
	above)s
		cross prod of deviance x_i and deviance sourrounding regions is
			positive, both deviances same direction, the higher the more deviance from mean
			negative, deviance x_i and deviance surrounding regions different direction
			close to zero, deviance x_i or deviance surrounding regions close to zero
		expected value, sum of all weight values/ n - 1. weights are normed by row sum, in row either 1or0
	expectation of local moran and global moran are equal
		-> global moran is mean of all local moran
		-> global moran between -1 and +1
	Getis-org G-statistics:
		local moran says nothing about "hot or cold spots"
		define distance matrix

29.01.20

DONE:
Did some plots for EDA
	read "Reconstructing coupled time series in climate systemsusing three kinds of machine-learning methods", LSTMS and Reservoir Computer seem to be interesting
	read how to read a paper


TODO:
read the paper niklas sent
	use "how to read a paper approach"
Also Transformers/Attention for Time Series Data.
	https://www.reddit.com/r/MachineLearning/comments/ckaji4/d_transformers_for_time_series_data/ew2pet4/
	https://towardsdatascience.com/attention-for-time-series-classification-and-forecasting-261723e0006d
	https://arxiv.org/pdf/2001.08317.pdf
read about different data sources where they come from, how they are computed etc
decide on a data-set
write expose
get supervisor
work further on EDA
	FIRST THING PLOTTTT!!! DONE
	mean ssts (maybe NTAO/STAO):
		for each month 
			compute for each year mean temperature in ongoing fashion
			(add jan 1901 jan 1902 ... jan 1910)/len(year, here = 10) -> mean 1910
			do that for all years
			plot each month individually
	how to plot anomalies? see S3, monthly anomlies, maybe plot it for a couple of random points or NTAO/STAO
	search EDA for geospatial data
ASK niklas:
	supplementary material, and paper "we compute monthly amomalies with respect to the long-term
		mean annual cycle"
		https://cfn-live-content-bucket-iop-org.s3.amazonaws.com/journals/1748-9326/15/9/094087/2/ERL_15_9_094087_suppdata.pdf?AWSAccessKeyId=AKIAYDKQL6LTV7YY2HIK&Expires=1611855089&Signature=eYawahUfQLQSPDIB1PKHUeVfWSI%3D
	El Nino index?

READING LIST:
papers from niklas
papers about the data sets
exploring and visualisigntime series
Exploratory Spatial Data Analysis!!!
	https://towardsdatascience.com/what-is-exploratory-spatial-data-analysis-esda-335da79026ee
	http://gispopsci.org/exploratory-spatial-data-analysis/
Animating Data Visualisation for development of the temperatures over time!!!
	https://towardsdatascience.com/animating-your-data-visualizations-like-a-boss-using-r-f94ae20843e3
search Machine Learning attention in extreme weather prediction, gives
	https://link.springer.com/article/10.1007/s10044-020-00898-1
Pattern Recognition





