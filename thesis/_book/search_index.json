[["index.html", "Predicting Droughts in the Amazon Basin based on Global Sea Surface Temperatures Introduction", " Predicting Droughts in the Amazon Basin based on Global Sea Surface Temperatures Dario Lepke Introduction With future climate change droughts in the Amazon forest may become more frequent and/or severe. Droughts can turn Amazon regions from rain forest into savanna, leading to high amounts of carbon released into the atmosphere. Therefore, predicting future droughts and understanding the underlying mechanisms is of great interest. Ciemer et al. (2020), established an early warning indicator for droughts in the central Amazon basin (CAB), based on tropical Atlantic sea surface temperatures (SSTs). In my thesis I would like to build on this work and improve the predictive power by using different statistical methods. Meaning, we seek to build a model that is able to predict droughts (resp. rainfall) based on preceding sea temperatures, desirably with as much lead time as possible. Also we want to identify those sea regions that are most important for doing so, making interpretability a point of interest, too. A first model could be a cross-validated (generalised) LASSO approach trying to identify the most important oceanic regions and the respective time-scales. The thesis will be done in cooperation with Dr. Niklas Boers from the Postdam Institute for Climate Impact Research (Climate Impact Research (PIK) e. V. (2021)). "],["lasso-og-timelag.html", "1 Lasso og timelag 1.1 LASSO model 1.2 Error plots 1.3 Coefficient plots 1.4 Inspect predictions from each fold 1.5 Inspect predictions from best CV-lambda 1.6 Summary", " 1 Lasso og timelag 1.1 LASSO model We fit a LASSO model on the precipitation and SST data. The precipitation target is the monthly mean precipitation in the Central Amazon Basin, the SST data are monthly temperatures over the globe. We use a 5-fold CV approach to find an optimal lambda. Each fold consists of 5 consecutive years of training data followed by 2 years of test data. In each fold we fit a LASSO model on a set of predetermined lambda values and choose the lambda that minimizes the MSE on the test set in that fold. After determining the best lambda in each fold we choose the lambda that minimizes the MSE over all folds and refit the model to the complete training data. Afterwards we evaluate the fitted model on a separate validation set with 5 years length which was not included in the training phase. 1.2 Error plots The plot shows the results from the 5 fold-CV plotted for each lambda. Lambda values start with high regularization and then decrease. Initially reducing regularization reduces the error until the 43th lambda value. As the errors get very large after the 60th lambda value and strictly increase we only showed the first 60 values for better visibility The highest regularization is chosen so that all coefficients are zero. In the above plot we can see the error curves for each fold. Folds 1,2 and 3 in the top row, left to right and folds 4 and 5 in the bottom row. We can see that initially that with decreasing regularization the MSE decreases as well. Up to a certain point after which the error rises again. Fold 4 seems to be the exception where a decrease in regularization does not increase the error dramatically as seen for example in folds 2 and 5 respectively. Below we can see the minimum MSE for each fold. ## [1] 416.1267 1814.5301 826.0119 627.4868 289.3691 And which lambda in the lambda vector resulted in the lowest prediction error on the folds´ test set. ## [1] 45 32 36 36 49 1.3 Coefficient plots The plots displays the nonzero coefficients in each fold computed for the lambda that minimizes the MSE on the test set in the respective fold. For all folds we see large negative coefficients in the arctic. The LASSO chooses among correlated variables only one and discards the others, which can be seen here since the variables chosen are scattered across the map and can but dont have to be close to each other. 1.4 Inspect predictions from each fold Following we inspect the folds precipitation time series and the predictions made by the model. ## [1] 429 43952 ## [1] FALSE ## [1] 429 43952 In general the model fits the data sufficiently to predict the general form of the time series but misses some modes and is off in the larger values in fold 2. 1.5 Inspect predictions from best CV-lambda We choose now the best lambda with the 1SE rule and fit the model anew to predict the time series we held out as validation data ## [1] 429 43952 ## [1] 37.06561 ## [1] 1373.86 Over the more than 5 years of validation data the model predicts the seasonal pattern of the precipitation time series quite well, but constantly fails to predict the higher values of precipitation. The MSE is 1215.74 and the RSME 34.87. 1.6 Summary We fitted a LASSO model for predicting the mean precipitation in the Central Amazon Basin and used a 5-fold blocked Cross Validation approach to find the optimal level of regularization. After training the model we evaluated its performance on a separate validation set that was not used in the training process. The model shows predicting capabilities but misses out on higher values of the precipitation target. Also although predicting seems to bring useful results, the choice of the LASSO coefficients seems somewhat arbitrary or at least not interpret able in a straightforward way. "],["fused-lasso-cv.html", "2 Fused Lasso CV 2.1 Error plots 2.2 Coefficient plots 2.3 Inspect predictions from each fold 2.4 Summary", " 2 Fused Lasso CV 2.1 Error plots The plot shows the results from the 5 fold-CV plotted for each lambda. Lambda values start with high regularization and then decrease. Initially reducing regularization reduces the error until the 43th lambda value. As the errors get very large after the 60th lambda value and strictly increase we only showed the first 60 values for better visibility The highest regularization is chosen so that all coefficients are zero. Below we can see the minimum MSE for each fold. ## [1] 1016.2804 2001.8214 1028.4894 897.3116 665.6149 And which lambda in the lambda vector resulted in the lowest prediction error on the folds´ test set. ## [1] 1 100 100 100 1 2.2 Coefficient plots ## [1] -7.589664229 0.006429624 ## ## -7.59 0.006 ## 2 3514 ## [1] -7.589664229 0.006429624 ## ## -7.59 0.006 ## 2 3514 ## [1] -7.589664229 0.006429624 ## ## -7.59 0.006 ## 2 3514 ## [1] -7.589664229 0.006429624 ## ## -7.59 0.006 ## 2 3514 2.3 Inspect predictions from each fold ## [1] 432 3516 ## [1] 14 100 ## [1] 14 100 ## [1] 14 100 Over the more than 5 years of validation data the model predicts the seasonal pattern of the precipitation time series quite well, but constantly fails to predict the higher values of precipitation. The MSE is 1215.74 and the RSME 34.87. 2.4 Summary We fitted a LASSO model for predicting the mean precipitation in the Central Amazon Basin and used a 5-fold blocked Cross Validation approach to find the optimal level of regularization. After training the model we evaluated its performance on a separate validation set that was not used in the training process. The model shows predicting capabilities but misses out on higher values of the precipitation target. Also although predicting seems to bring useful results, the choice of the LASSO coefficients seems somewhat arbitrary or at least not interpret able in a straightforward way. "],["results-lasso-og-scale.html", "3 Results LASSO og scale", " 3 Results LASSO og scale "],["lasso-on-original-data.html", "4 Lasso on original data 4.1 LASSO model 4.2 Error plots 4.3 Coefficient plots 4.4 Inspect predictions from each fold 4.5 Inspect predictions from best CV-lambda", " 4 Lasso on original data 4.1 LASSO model We fit a LASSO model on the precipitation and SST data. The precipitation target is the monthly mean precipitation in the Central Amazon Basin, the SST data are monthly temperatures over the globe. We use a 5-fold CV approach to find an optimal lambda. Each fold consists of 5 consecutive years of training data followed by 2 years of test data. In each fold we fit a LASSO model on a set of predetermined lambda values and choose the lambda that minimizes the MSE on the test set in that fold. After determining the best lambda in each fold we choose the lambda that minimizes the MSE over all folds and refit the model to the complete training data. Afterwards we evaluate the fitted model on a separate validation set with 5 years length which was not included in the training phase. 4.2 Error plots ## [1] 590.0167 1883.5540 775.5926 598.5691 350.5754 And which lambda in the lambda vector resulted in the lowest prediction error on the folds´ test set. ## [1] 33 45 59 47 38 4.3 Coefficient plots 4.4 Inspect predictions from each fold Following we inspect the folds precipitation time series and the predictions made by the model. In general the model fits the data sufficiently to predict the general form of the time series but misses some modes and is off in the larger values in fold 2. 4.5 Inspect predictions from best CV-lambda We choose now the best lambda with the 1SE rule and fit the model anew to predict the time series we held out as validation data ## [1] 35.15291 ## [1] 1235.727 "],["results-lasso-og-center.html", "5 Results LASSO og center 5.1 LASSO model 5.2 Error plots 5.3 Coefficient plots 5.4 Inspect predictions from each fold 5.5 Inspect predictions from best CV-lambda", " 5 Results LASSO og center 5.1 LASSO model We fit a LASSO model on the precipitation and SST data. The precipitation target is the monthly mean precipitation in the Central Amazon Basin, the SST data are monthly temperatures over the globe. We use a 5-fold CV approach to find an optimal lambda. Each fold consists of 5 consecutive years of training data followed by 2 years of test data. In each fold we fit a LASSO model on a set of predetermined lambda values and choose the lambda that minimizes the MSE on the test set in that fold. After determining the best lambda in each fold we choose the lambda that minimizes the MSE over all folds and refit the model to the complete training data. Afterwards we evaluate the fitted model on a separate validation set with 5 years length which was not included in the training phase. 5.2 Error plots ## [1] 480.6819 1375.0218 851.4443 500.4939 293.8763 And which lambda in the lambda vector resulted in the lowest prediction error on the folds´ test set. ## [1] 48 46 42 45 15 5.3 Coefficient plots 5.4 Inspect predictions from each fold Following we inspect the folds precipitation time series and the predictions made by the model. In general the model fits the data sufficiently to predict the general form of the time series but misses some modes and is off in the larger values in fold 2. 5.5 Inspect predictions from best CV-lambda We choose now the best lambda with the 1SE rule and fit the model anew to predict the time series we held out as validation data ## [1] 34.90595 ## [1] 1218.426 "],["related-work.html", "6 Related work", " 6 Related work As already mentioned the paper by Ciemer et al. (2020), created an early warning indicator for Amazon droughts. They did so using a complex network approach. They used two datasets, one for the Sea Surface Temperatures (Smith et al. (2008)) and one for the precipitation (Funk et al. (2015)) with monthly data for the time period of 1981 until 2016. The data can be downloaded for example in netcdf format and manipulated conveniently with Climate Data Operators (CDO, Schulzweida (2019)). CDO in turn can be used with wrappers for R and Python. The data is organized on a longitude/latitude grid. They identify 4 oceanic regions that correlate the most with rain in the amazon basin, using a coupled network approach. Figure 6.1 shows the cross degree towards rainfall in the central Amazon basin (CAB, blue box), for positive and negative correlations. Darker shades indicate a larger cross degree, hence a larger number of links and correlations with rainfall at more grid points in the CBA. The correlations are measured using a spearman rank-order correlation coefficient \\[\\begin{equation} \\rho = 1 - \\frac{6\\sum\\Delta_{R_i}^2}{n(n^2-1)} . \\tag{6.1} \\end{equation}\\] Where \\(\\Delta_{R_i}\\) denotes the difference between the ranks of observations of both variables at the same time \\(i\\) and \\(n\\) is the number of observations. An Adjacency Matrix describes the resulting network, where the threshold \\(p_{th}\\) was chosen so that only 10% of the strongest correlations are represented as links in the network \\[\\begin{equation} A_{ij} = \\begin{cases}0 \\textrm{ } p_{ij} &lt; p_{th}\\\\ 1 \\textrm{ } p_{ij}\\geq p_{th}\\\\\\end{cases} . \\tag{6.2} \\end{equation}\\] The cross degree then gives the strength of correlation between a specific grid point \\(i\\) of network \\(V_l\\) (oceanic grid point) and another (sub)network \\(V_m\\) (all grid points \\(j\\) in central amazon basin) \\[\\begin{equation} k_{i}^{lm} = \\sum\\limits_{j \\in V_m} A_{ij}, i \\in V_l\\ . \\tag{6.3} \\end{equation}\\] Figure 6.1: Cross degree between sea surface temperature and continental rainfall anomalies. For each sea surface temperature grid cell of the Atlantic and Pacific Ocean, the cross degree towards rainfall in the Central Amazon Basin (blue box) is shown, for a positive correlations and b negative correlations. Darker shading indicates a larger cross degree, implying a larger number of links, and thus significant correlations with rainfall at more grid points in the Central Amazon Basin. Red areas outline coherent oceanic regions with a the 20% highest cross degrees for positive correlations, found in the Southern Pacific Ocean (SPO) and Southern Tropical Atlantic Ocean (STAO), and b the 20% highest cross degrees for negative correlations, found in the Central Pacific Ocean (CPO) and Northern Tropical Atlantic Ocean (NTAO) (Ciemer et al. 2020) They further explore the relationship by constructing (weighted) networks for sliding windows of 24 months between the Central Amazon Basin and each of the ocean regions. For each month except for the first two years, an individual network is computed based on the data of the previous 24 months. Then they take the average of the cross correlations for each of the networks which gives a new time series of average cross correlation (ACC) values. Each ACC summarizes the connectivity of one region with the CAB for the last 24 months. They find that NTAO and STAO give the strongest signal, hence they apply the same sliding window coupled network approach between the ocean regions NTAO and STAO. Before they computed networks between ocean and continental regions, now it is computed between these two Atlantic regions, NTAO and STAO. The resulting time series and its comparison to the drought index time series is shown in figure 6.2 below. They find that using a ACC threshold for a drought (SPI below -1.5), lets them forecast 6 of the 7 droughts in the observation period, missing the 2005 drought, while also giving one false alarm in 2002. Figure 6.2: Early-warning signal for droughts in the central Amazon basin. We compare the time evolution of the average cross correlation of the Northern Tropical Atlantic Ocean (NTAO) and Southern Tropical Atlantic Ocean (STAO), given by the blue curve, with the standardized precipitation index (SPI, orange) of the central Amazon basin. Orange dips indicate a negative SPI with a threshold for severely dry periods (SPI -1, dotted red line). We expect a drought event within the following one and a half years whenever the average cross correlation between NTAO and STAO SST anomalies falls below an empirically found threshold of -0.06. Green circles indicate a matching forecast based on the Atlantic SST correlation structure, with one false alarm in 2002 indicated by a grey circle, where the threshold is crossed but no drought took place in the direct aftermath (see Discussion). The temporal evolution of the average cross correlation shown here is smoothed using a Chebyshev type-I low-pass filter with a cutoff at 24 months (Ciemer et al. 2020). The work by Ciemer et al. (2020) shows potential forecasting capabilities and limitations. While they are able to predict 5 out of 6 drought events, they also give one false negative and one false positive result. Their work uses a complex network approach that is applied stepwise (first two unweighted networks, then two weighted networks and in the end a dichotomous threshold decision rule). For the thesis we would like to create a more general predictive model that can learn the relationship between the SSTs and rainfall in the CAB. As already mentioned a first step can be a LASSO model. First findings show that, the classic LASSO only chooses single points in the ocean as predictors, though. But our motivation is to discover predictive regions and not only single separated points. Therefore in a next step we want to make use of a generalized form of the LASSO that also takes into account that chosen predictors should be close to each other. This model is the so called Fused LASSO. For the models we also need a form of evaluation. Classic Cross Validation assumes independence of the observations. In our setting this is clearly violated due to the time dependency of the data. We will explore different possibilities to use an adjusted form of Cross Validation that takes this characteristic into account. Depending on how well the relationship between SST and rain can be established, we can take this a step further and use it as a so called Emergent Constraint (EC). Since different climate models give different answers about future climate there is a need to narrow this spread, which can be done by ECs. To do so, we need a plausible relationship between a Variable X and Y (here: SST and drought). According to how well the relationship is represented in a climate model we assign credibility to a climate models future projections (here: projections of future droughts in the Amazon rain forest). In summary this can be used to reduce uncertainty in the ensemble of climate models future projections, f.e by using ML techniques as done by Schlund et al. (2020). "],["eda-precipitation.html", "7 EDA precipitation 7.1 Overview 7.2 Precipitation values raw 7.3 Mean at each location 7.4 SD at each location 7.5 Mean and SD at each location 7.6 Trend at each location 7.7 Means per month TEST 7.8 SD per month TEST 7.9 Trend per month TEST", " 7 EDA precipitation In this section we want study the time series of precipitation in the Central Amazon Basin. The CHIRPS data set contains the precipitation data, created from in-situ and satellite measurements (Funk et al. (2015)). It can be downloaded for example from here [https://www.chc.ucsb.edu/data/chirps]. It contains observations from 1981 to 2021. Data comes on a high resolution of 0.05 grid. Time frame: 1980 to 2016 7.1 Overview Below the area of the Central Amazon Basin that is object of our study. Figure 7.1: Localisation of the area under study. The central amazon basin (CAB) spanning across 0,-10 latitude and -70,-55 longitude 7.2 Precipitation values raw Firstly we inspect the precipitation values in general Its form is a unimodal, right-skewed distribution. The values range from r[1] tom r[2]. 7.3 Mean at each location Figure 7.2: Precipitation mean at each location. The mean was computed over the whole time period Figure 7.3: Density of means, means were computed for each location over the whole time period As we can see most locations have a mean precipitation of around 200 mm/month, over the whole time series. Regionally in the upper left corner of the Amazon Basin, mean precipitation is higher or equal to the mean. The reference point for higher is the mean of the location means. This region seems to be more or less spatially consistent. The rest of the region with lower mean precipitation has also some small areas where precipitation is again a little bit higher. For example in the upper right corner and on the bottom, right of the middle. 7.4 SD at each location Figure 7.4: Precipitation standard deviation at each location. The standard deviation was computed over the whole time period Figure 7.5: Density of standard deviations, standard deviations were computed for each location over the whole time period For the standard deviation we also see regional patterns. These patterns overlap with the regions of the mean but their magnitude is flipped. Meaning, in the upper left where we observe larger mean values we generally observe lower standard deviation and in the lower and upper right corners, higher standard deviations. Question: There are obviously regional differences in magnitude of mean and standard deviations. Should we therefore NOT normalise the time series, prior to clustering? Mean and SD contain information and the variables are all measured on the same scale. (Consideration: seasonality might play a role, meaning that the values of different months come a different distribution) 7.5 Mean and SD at each location 7.6 Trend at each location Many regions dont have a trend and trends in general seem to be quite small. We can identify some regions with similar up or downward trends. We also computed plots for the deseasonalised data but it looked almost the same Plot means and sd for each month respectively 7.7 Means per month TEST We see spatial patterns of the mean evolving over time. For example: From May until August there is a spatial separation in two parts that dissolves in september. As expected there is a large seasonal component regarding the means. 7.8 SD per month TEST For the standard deviation we see as well large differences in values during different months of the year. 7.9 Trend per month TEST "],["eda-sst.html", "8 EDA SST 8.1 SST values raw 8.2 Mean at each location 8.3 SD at each location 8.4 Mean and SD at each location 8.5 Trend at each location 8.6 SD per month TEST 8.7 Trend per month TEST", " 8 EDA SST We explore the sea surface temperature data set, used in the paper by Ciemer et al (Ciemer et al. (2020)). ERSST (Extended Reconstructed Sea Surface Temperature, Huang et al. (2017)) is a reanalysis from observed data given in the International Comprehensive Ocean-Athmosphere Data Set (ICOADS). Which contains observations from 1800/01 until 2016/12, made by ships and buoys for example. The data comes on a 2x2 degree grid, where data was missing interpolation techniques were used. See paper for reference. the file contains two variables that are measured across different dimensions. The two variables contain the sea surface temperatures and the respective SST anomalies (with respect to the 1971-2000 monthly climatology). 8.1 SST values raw 8.2 Mean at each location 8.3 SD at each location Figure 8.1: SST standard deviation at each location. The standard deviation was computed over the whole time period Figure 8.2: Density of standard deviations, standard deviations were computed for each location over the whole time period 8.4 Mean and SD at each location 8.5 Trend at each location ## Means per month TEST We see spatial patterns of the mean evolving over time. For example: From May until August there is a spatial separation in two parts that dissolves in september. As expected there is a large seasonal component regarding the means. 8.6 SD per month TEST For the standard deviation we see as well large differences in values during different months of the year. 8.7 Trend per month TEST "],["glyph-plots.html", "9 Glyph plots", " 9 Glyph plots Figure 9.1: Glyph map of seasonal precipitaton pattern. Each location is presented by a time series. The time series are seperated by boxes. The gray reference lines inside the boxes show the mid-range for easier comparison. The above figure is a glyph-map of seasonal precipitation patterns (averages for each month) in the Central Amazon Basin. The gray reference lines show the mid-range for easier comparison of the patterns. We see differences in the seasonal patterns across the map. In the upper left for example, the seasonal patterns stay above mid-range while on the bottom-left they have values clearly towards the low end of the range. Also some areas have multimodal patterns. The patterns differ in range and month of maximum and minimum precipitation. Figure 9.2: Glyph map of de-seasonalised and smoothed precipitation. Each location is presented by a time series. The time series are seperated by boxes. The gray reference lines inside the boxes show the mid-range for easier comparison. The time series are scaled globally, same positions inside the cells correspond to the same values in all locations. This plot shows the smoothed de-seasonalized monthly precipitation, after global scaling. The same position within each cell corresponds to the same value in all locations. Some areas have almost a linear course, increasing, decreasing or constant. Others show a more wiggly courses. As overall pattern we can see that the forms of the patterns have a spatial connection, patterns are close to similar patterns, at the same latitude. Also regarding latitude the closer to the equator the less precipitation. Figure 9.3: Glyph map of de-seasonalised and smoothed precipitation. The time series are scaled locally, ranges are not the same in all cells. The different ranges are given in color shades, where lighter shading indicates a larger range and darker shades smaller ranges. Now we inspect the glyph-map with de-seasonalized locally scaled values. This form of scaling emphasizes the individual shapes. Because of the applied scaling, big patterns may be just be tiny effects. Therefore colors are added according to range. Areas with lighter color have larger ranges than darker areas. The areas with steep linear increases and decreases have smaller ranges than or example the areas below -2.5 latitude in the left. "],["correlation-analysis.html", "10 Correlation analysis 10.1 Short Recap 10.2 Correlation of Sea Surface Temperature and Precipitation 10.3 Summary", " 10 Correlation analysis 10.1 Short Recap We give a short overview over the correlation between monthly sea surface temperature and monthly mean precipitation in the Central Amazonas Basin (CAB). First we will analyse the original and then the deaseasonalised data. SST and precipitation data have been deseasonalised, meaning first each time series was decomposed by the stl algorithm according to \\[Monthly \\textit{ } Data = Seasonal + Trend + Remainder\\] Afterwards only trends and remainders time series were kept to constitute a new time series that will be used as predictor (sst) and target (precipitation). In a next step we compute the correlations between each sst grid point time series and the mean precipitation time series. Since our goal is to predict the precipitation on the sst information, we are also interested in predicting future precipitation some months ahead. To examine this we also compute the correlations for different time lags. For example we might use January sst data to predict precipitation in June, given a time lag of 6 months. We consider time lags of 0,3,6 and 12 months. And show the density of the correlation values as well as their spatial distribution on a map. We also display the highest positive and negative correlation based on their respective 2.5% and 97.5% quantiles. All correlations that are between these values are set to 0 then. The correlation measure we use is the 10.2 Correlation of Sea Surface Temperature and Precipitation 10.2.1 Original Data Following, for each timelag we show the respective density of correlation values, their location on the map and also the 5% strongest positive and negative correlations. 10.2.1.1 Timelag 0 Inspecting the density plot for timelag 0, we see two modi for correlations, one for negative correlations around -0.8 and one for possitive correlations around 0.8. Also a small spike can be seen for low negative correlations. If we plot these correlations on the respective grid points we see a clear north-south negative-positive correlation distinction. The boarder is organised around the equator. The plot for the strongest 5% of correlations reveals areas with strong positive and negative correlations in the north and south respectively. 10.2.1.2 Timelag 3 The density of correlations for timelag 3, is left-skewed and has two modi that are organised around 0 and -0.125 respectively. The correlation map shows that the high positive and negative correlations are more close to equator here. Note that the legend for the correlationmap is shifted here, because the maximal negative correlation has a higher absolute value than the maximal positive correlation. The strongest correlations also seem to be shifted towards the equator. 10.2.1.3 Timelag 6 We can see the density plot for timelag 6 is pretty similar to the one of timelag 0 but seems to be flipped around 0. Similarly the correlation map shows (high) negative correlations in the south now and high postive correlations in the north. 10.2.1.4 Timelag 12 Giving a timelag of one year, we can see that the distribution of correlations is now again similar to the distribution for timelag 0. This also hold for the location of positive and negative correlations in general, as well as for the strongest 5% of correlations. 10.2.2 Deseasonalised Data Following, for each timelag we show the respective density of correlation values, their location on the map and also the 5% strongest positive and negative correlations. 10.2.2.1 Timelag 0 Inspecting the density plot for timelag 0, we see that after excluding seasonality from the time series we get a left-skewed distribution of correlations. With a mode around 0. In general the correlation values are a lot lower than in the original data. With a maximum at around -0.4 and +2.5 respectively. We plot these correlations on the respective grid and see that the clear north south distinction in the correlations before deseasonalising the data does not appear anymore. The plot for the strongest 5% of correlations reveals areas with strongest positive and negative correlations. But as stated before the values are in general much lower. 10.2.2.2 Timelag 3 For the density of timelag 3 we get a similar picture as for timelag 0. The mode is a higher and the tails get a bit more mass. Also the correlation map does not seem to change a lot. The strongest correlations appear to be shifted to the left. 10.2.2.3 Timelag 6 Since the distributions of correlation values are all unimodal we do not observe the flip we saw in the original data when comparing the densities of timelag 0 and 6. The mode again gets larger and the maximum postive and negative correlation values get smaller. The strongest negative correlations are shifted further to left. 10.2.2.4 Timelag 12 Given a timelag of one year, the distribution now has a mode around 6, and started at around 4 when timelag was 0. Also neither the positive nor negative correlations exceed values of 2.5. The consistent region of strong negative and positive correlations is now less organised or more scattered. 10.3 Summary 10.3.1 Original Data We can observe that the positive and negative correlations of sst and precipitation follow a spatial and temporal pattern. The location and density of the positive and negative correlation wanders over the equator in opposite directions. The densities and correlationmaps for timelag 0 and 6 appear to be quite similar but flipped. The densities and correlationmaps for timelag 0 and 12 appear again to be similar. The same pattern seems to hold for the strongest correlations. 10.3.2 Deseasonalised Data Correlation values are in general a lot lower than in the original data and decrease with increasing timelag. We still observe temporal and regional patterns, although these dissolve a bit for a timelag of 12. In this chapter we will first summarize the main ideas of clustering and then apply it to the precipitation data. If not indicated otherwise the information is taken from Elements of Statistical Learning. "],["main-idea-clustering.html", "11 Main Idea Clustering", " 11 Main Idea Clustering We can describe an object by a set of measurements or its similarity to other objects. Using this similarity we can put a collection of objects into subgroups or clusters. The objects in the subgroups should then be more similar to one another than to objects of different subgroups. This means inside the clusters we aim for homogeneity and for observations of different clusters for heterogeneity. With the clustering analysis applied to the precipitation data we want to study if there are distinct groups (regions) apparent in the CAB. So that if we later apply the regression models we predict the precipitation for each group and not for the whole region. To explore the grouping in the data we need a measure of (dis)similarity. This measure is central and depends on subject matter considerations. We construct the dissimilarities based on the measurements taken for each month. We interpret this as a multivariate analysis where, each month is one variable. So given the area in the CAB (resolution 5°x5°), we have 612 cells and 432 months, resulting in a \\(612 \\times 432\\) data matrix. we want to cluster cells into homogen groups. "],["clustering-methods.html", "12 Clustering Methods 12.1 K-means 12.2 K-medoids 12.3 PCA 12.4 Gap statistic", " 12 Clustering Methods 12.1 K-means In the following we briefly describe the K-means procedure. Beforehand we have to specify a number of clusters \\(C\\) we believe exist in our data. Then we randomly initialize \\(C\\) cluster centers in the feature space. Now two steps are repeated until convergence: For each center we identify the points that are the closest to this center. These points belong now to a cluster \\(C\\). In each cluster we compute the mean of each variable and get a vector of means. This mean vector is now the new center of the cluster. As a measure of dissimilarity we use the Euclidean distance: \\[\\begin{equation} d(x_i,x_{i´}) = \\sum_{j=1}^p(x_{ij}-x_{i´j})^2=||x_i-x_{i´}||^2 \\tag{12.1} \\end{equation}\\] Meaning for the points \\(i\\) and \\(i´\\) we compute the squared difference for each variable and sum them up. As stated above we are searching for clusters that are themselves compact, meaning homogeneous. We do so by minimizing the mean scatter inside the clusters. We summarize this scatter as within-sum-of-squares \\[\\begin{equation} W(C) = \\frac{1}{2} \\sum_{k=1}^{K} \\sum_{C(i)=k} \\sum_{C(i´)=k} ||x_i-x_{i´}||^2 \\\\ = \\sum_{k=1}^K N_k \\sum_{C(i)=k} ||x_i-\\bar{x}_k ||^2 \\tag{12.2} \\end{equation}\\] where \\(\\bar{x} = (\\bar{x}_{1k},...,\\bar{x}_{pk})\\) stands for the mean vectors of the \\(k\\)th cluster and \\(N_k = \\sum_{i=1}^N I(C(i)=k)\\). 12.1.1 Kmeans characteristics variance of each distribution of each attribute (variable) is spherical, variance is symmetrical? all variables have same variance, not the case in our example, therefore scaling or pca equal number of observations in each clusters, we don`t know Since we use the Euclidean distance the similarity measures will be sensitive to outliers and scale. K-means assumes that the variance of a variable´s distribution is spherical, meaning it wight not work well in situations that violate this assumptions (f.e non-spherical data). Further assumptions are same variance of the variables, and equally sized clusters. Now how large these violations have to be so that k-means does not work well anymore has no clear-cut answer. 12.2 K-medoids We can adjust k-means procedure so that we can use other distances than the Euclidean distance. The only part of the k-means algorithm that uses Euclidean distance is when we compute the cluster centers. We can replace this step by formalizing an optimization with respect to the cluster members. For example so that each center has to be one of the observations assigned to the cluster. K-medoids is far more computationally intensive than K-means. 12.2.1 K-medoids characteristics K-medoids is less sensitive to outliers, because it minimizes sum of pairwise dissimilarities instead of sum of squared Euclidean distances. As stated above it is also more computationally intensive. 12.3 PCA Goal is reduction of correlated and eventually large number p variables to a few. We accomplish this by creating new variables that are linear combinations of the original ones. We call these new variables principle components. The new variables are not correlated any more and ordered according to the variance they explain. The first \\(k &lt; p\\) principal components then contain the majority of variance (Fahrmeir et al. (1996)). As they are ordered they also provide a sequence of best linear approximations of our data. Let \\(x_1, x_2,...,x_N\\), be our observations and we represent them by a rank-q linear model \\[\\begin{equation} f(\\lambda) = \\mu + V_q\\lambda \\tag{12.3} \\end{equation}\\] with \\(\\mu\\) a location vector in \\(\\mathbb{R}^p\\) and \\(V_q\\) is a \\(p \\times q\\) matrix with columns being orthogonal unit vectors as columns. \\(\\lambda\\) is a \\(q\\) vector of parameters. In other words we are trying to fit a hyperplane of rank q to the data. If we fit this model to minimize reconstruction error using least squares we solve \\[\\begin{equation} \\min_{\\mu, \\{\\lambda_i\\}, V_q } \\sum_{i=1}^N||x_i - \\mu - V_q\\lambda_i ||^2 \\tag{12.4} \\end{equation}\\] If we partially optimize for \\(\\mu\\) and \\(\\lambda_i\\) we obtain \\[ \\hat{\\mu} = \\bar{x},\\] \\[\\hat{\\lambda_i} = V_q^T(x_i - \\bar{x}) \\] Therefore we need to search for the orthogonal matrix \\(V_q\\) \\[\\begin{equation} \\min_{V_q} \\sum_{i=1}^N ||(x_i-\\bar{x}) - V_qV_q^t(x_i-\\bar{x})||^2 \\tag{12.5} \\end{equation}\\] We can assume here that \\(\\bar{x}\\) is 0, if this not the case we can simply center the observations \\(\\tilde{x}_i = x_i - \\bar{x}\\). \\(H_q = V_qV_q^T\\) projects each observation \\(x_i\\) from the original feature space onto the subspace that is spanned by the columns of \\(V_q\\). \\(H_qx_i\\) is then the orthogonal projection of \\(x_i\\) Hence \\(H_q\\) is also called the projection matrix. We find \\(V_q\\) then by constructing the singular value decomposition of our data matrix X. \\(X\\) contains the (centered) observations in rows, giving a \\(N \\times p\\) matrix. The SVD is then: \\[\\begin{equation} X = UDV^T \\tag{12.6} \\end{equation}\\] Where \\(U\\) is an orthogonal matrix containing the left singular vectors \\(u_j\\) as columns, and \\(V\\) contains the right singular vectors \\(v_j\\). The columns of \\(U\\) span the columns space of \\(X\\) and the columns of \\(V\\) span the row space. \\(D\\) is diagonal matrix which contains singular values, \\(d_1 \\leq d_2 \\leq ... \\leq d_p \\leq 0\\). Singular values are square roots of non-negative eigenvalues. The columns of \\(UD\\) are the principal components of \\(X\\). So the SVD gives us the matrix \\(V\\) (the first \\(q\\) columns give the solution to the minimization problem above) as well as the principal components from \\(UD\\) (Hastie et al. (2009)). 12.4 Gap statistic The idea of the gap statistic was introduced by Tibshirani, Walther, and Hastie (2001) As stated above we usually measure how compact our clusters are by assessing \\(W(C)\\) or \\(log(W_c)\\). Where low values indicate compact clusters. To compare the value then, we need a reference. We therefore want to estimate how large \\(W_c\\) were if there were no clusters present in our data. The larger the difference between the \\(W_c\\) from the data and the one from the reference the more likely we are to say that the found number of clusters is indeed correct. We construct reference data by sampling from a uniform distribution based on our data. Say we have \\(p\\) variables. We sample \\(n\\) times from each of the \\(p\\) uniformly distributed variables, where maximum and minimum are obtained from our data. We then cluster the reference data in the same we cluster our observed data and compute \\(W_c\\). We repeat this process several times and compute the average of \\(W_c\\), \\(E \\{log(W_c)\\}\\). The gap statistic is then the difference \\[\\begin{equation} E \\{log(W_c) \\} - log(W_c). \\tag{12.7} \\end{equation}\\] So in cases where our data is formed of clusters we would expect a high gap statistic. As Tibshirani, Walther, and Hastie (2001) note and as it is also done in the used R function clusgap, doing a PCA on the data and compute the gap statistic on the PCA scores can improves the results of gap statistic. "],["clustering-results.html", "13 Clustering results 13.1 K-means and PAM gap statistics without PCA 13.2 K-means and PAM gap statistics after applying PCA 13.3 Summary", " 13 Clustering results We summarize and compare the results we obtain if we center or dont center the data. 13.1 K-means and PAM gap statistics without PCA Figure 13.1: Gap statistics for different number of clusters k, for the K-means (left) and the PAM (right) algorithm respectively. The dashed line indicates the optimal number of clusters found. We can see that on the original data, neither K-means nor PAM find an optimal number of clusters that is lower than the maximum number specified. 13.1.1 Scree plot Figure 13.2: Scree plot with the principal components on the x-axis and the respective percentage of variance explained on the y-axis. The PCA was done after centering the data.The first three and four PC`s together explain 67.77 and 70.69% of the variance respectively We apply a PCA on the centered data. The variance that is explained by the principal components indicates that, the 3 principal components already explain a lot of the appearing variance in the data. We now study the gap statistic results for K-means and K-medoids (here, meaning PAM) after applying the PCA and choosing the number of principal components to be used. Following we compare the results of a gap statistic when the first 3 and 4 principal components are used, for K-means and PAM respectively. The first three and four PC`s used explain 67.77 and 70.69% of the variance respectively. 13.2 K-means and PAM gap statistics after applying PCA Figure 13.3: Gap statistic plots for K-means and PAM when using 3 and 4 PCs respectively. The graphic shows the gap statistics resulting from K-means and PAM for 3 and 4 principal components respectively. When 3 principal components are used K-means and PAM find 5 and 12 as optimal number of clusters, respectively. When we choose to use the first 4 principal components, both algorithms choose 13 as the optimal number. 13.3 Summary We used the gap statistic as evaluation tool to find the optimal number of clusters in our data. It was applied by using K-means and PAM as cluster algorithms, on the centered data with and without applying a pca beforehand. When applied without PCA, PAM and K-means found the maximal number of clusters optimal, regardless of centering. The results differed regarding centering the data when a PCA was applied. When the data was centered before the PCA, we find 5 and 12 (3 principal components, K-means and PAM, respectively) and 13 (4 principal components, both K-means and PAM) as optimal number of clusters. The results overall vary greatly and are sensitive to choices such as number of principal components, the algorithm and the decision criterion (here Tibshirani, Walther, and Hastie (2001)). The value of the clustering itself can be evaluated only when used in combination with regression. If useful, fitting different models for the different clusters should result in a lower overall average prediction error. We will proceed by using K-means for finding 5 clusters after applying a PCA on the centered data and use 3 principal components. "],["analyse-clustering-results.html", "14 Analyse clustering results", " 14 Analyse clustering results We now analyze further the results we found. Namely the clusters we find after performing a PCA on the data, using the 3 first principal components and searching for 5 clusters using k-means. The first 3 principal components explain 67.8% of the variance We found 5 as optimal number of clusters based on the gap statistic and the criteria from Tibsherani. We show the map plot for the k-means clustering after applying the PCA as well as the time series of the resulting clusters. Figure 14.1: Spatial distribution of the found clusters in the CAB. We applied a centered PCA on the data and used 3 principal components before applying the K-means algorithm The plot above shows the grid cells in the Central Amazon Basin colored according to the clusters that are assigned by k-means. The clusters are almost completely spatially coherent. Meaning that the clusters are not scattered across different areas. One exception can be seen for Cluster 1 and 4. Parts of cluster 1 (orange) are inside cluster 4 (blue) and on the edge to cluster 3 (green). Figure 14.2: Plots of the time series in the clusters we found using the K-means algorithm. The x-axis shows the month of measurement, the y-axis the centered precipitation. Centering was done according to the overall CAB mean in each month. The mean inside each cluster for a month is displayed in blue. We now inspect the original (centered) time series inside the clusters. The time series are shown in gray and the monthly mean in the cluster is shown in blue. Since the time series are centered before applying the PCA and clustering, the zero value is the mean of the respective month of the whole CAB. The clusters differ in their monthly differences from the monthly CAB mean (here 0 because the time series were centered before PCA and K-means) and their fluctuation/ variance. Also the size of the clusters are not all the same. The mean in cluster 3 has lowest variability around the CAB mean, followed by clusters 2 and 5, and clusters 1 and 4 have the highest variability. On average cluster 3 is on the level of the CAB overall mean. The clusters 2 and 5 are slightly below and cluster 4 is above the CAB mean, on average. Cluster 1 is on average also on the CAB mean but shows more variance than cluster 3. "],["lasso-on-original-data-1.html", "15 Lasso on original data 15.1 LASSO model 15.2 Error plots 15.3 Coefficient plots 15.4 Inspect predictions from each fold 15.5 Inspect predictions from best CV-lambda 15.6 Summary", " 15 Lasso on original data 15.1 LASSO model We fit a LASSO model on the precipitation and SST data. The precipitation target is the monthly mean precipitation in the Central Amazon Basin, the SST data are monthly temperatures over the globe. We use a 5-fold CV approach to find an optimal lambda. Each fold consists of 5 consecutive years of training data followed by 2 years of test data. In each fold we fit a LASSO model on a set of predetermined lambda values and choose the lambda that minimizes the MSE on the test set in that fold. After determining the best lambda in each fold we choose the lambda that minimizes the MSE over all folds and refit the model to the complete training data. Afterwards we evaluate the fitted model on a separate validation set with 5 years length which was not included in the training phase. 15.2 Error plots The plot shows the results from the 5 fold-CV plotted for each lambda. Lambda values start with high regularization and then decrease. Initially reducing regularization reduces the error until the 43th lambda value. As the errors get very large after the 60th lambda value and strictly increase we only showed the first 60 values for better visibility The highest regularization is chosen so that all coefficients are zero. In the above plot we can see the error curves for each fold. Folds 1,2 and 3 in the top row, left to right and folds 4 and 5 in the bottom row. We can see that initially that with decreasing regularization the MSE decreases as well. Up to a certain point after which the error rises again. Fold 4 seems to be the exception where a decrease in regularization does not increase the error dramatically as seen for example in folds 2 and 5 respectively. Below we can see the minimum MSE for each fold. ## [1] 480.6819 1375.0218 851.4443 500.4939 293.8763 And which lambda in the lambda vector resulted in the lowest prediction error on the folds´ test set. ## [1] 48 46 42 45 15 15.3 Coefficient plots The plots displays the nonzero coefficients in each fold computed for the lambda that minimizes the MSE on the test set in the respective fold. For all folds we see large negative coefficients in the arctic. The LASSO chooses among correlated variables only one and discards the others, which can be seen here since the variables chosen are scattered across the map and can but dont have to be close to each other. 15.4 Inspect predictions from each fold Following we inspect the folds precipitation time series and the predictions made by the model. In general the model fits the data sufficiently to predict the general form of the time series but misses some modes and is off in the larger values in fold 2. 15.5 Inspect predictions from best CV-lambda We choose now the best lambda with the 1SE rule and fit the model anew to predict the time series we held out as validation data ## [1] 34.86753 ## [1] 1215.744 Over the more than 5 years of validation data the model predicts the seasonal pattern of the precipitation time series quite well, but constantly fails to predict the higher values of precipitation. The MSE is 1215.74 and the RSME 34.87. 15.6 Summary We fitted a LASSO model for predicting the mean precipitation in the Central Amazon Basin and used a 5-fold blocked Cross Validation approach to find the optimal level of regularization. After training the model we evaluated its performance on a separate validation set that was not used in the training process. The model shows predicting capabilities but misses out on higher values of the precipitation target. Also although predicting seems to bring useful results, the choice of the LASSO coefficients seems somewhat arbitrary or at least not interpret able in a straightforward way. "],["lasso-on-deseasonalised-data-with-correlation-preselection.html", "16 Lasso on deseasonalised data with correlation preselection 16.1 Error plots 16.2 Inspect predictions from best CV-lambda", " 16 Lasso on deseasonalised data with correlation preselection 16.1 Error plots ## Coefficient plots ## Inspect predictions from each fold ## [1] 432 10988 16.2 Inspect predictions from best CV-lambda ## [1] 3 ## [1] 432 10988 ## [1] 62 1 ## [1] 32.25297 ## [1] 1040.254 "],["lasso-on-original-data-with-correlation-preselection.html", "17 Lasso on original data with correlation preselection 17.1 Error plots 17.2 Inspect predictions from best CV-lambda", " 17 Lasso on original data with correlation preselection 17.1 Error plots ## Coefficient plots ## Inspect predictions from each fold ## [1] 432 10988 17.2 Inspect predictions from best CV-lambda ## [1] 432 10988 ## [1] 62 1 ## [1] 36.0622 ## [1] 1300.483 "],["lasso-deseasonalised.html", "18 Lasso deseasonalised 18.1 Inspect predictions from best CV-lambda", " 18 Lasso deseasonalised ## [1] 432 10988 18.1 Inspect predictions from best CV-lambda ## [1] 432 10988 ## [1] 62 1 ## [1] 38.64054 ## [1] 1493.091 "],["lasso-on-ssta.html", "19 Lasso on ssta 19.1 LASSO model 19.2 Error plots 19.3 Coefficient plots 19.4 Inspect predictions from each fold 19.5 Inspect predictions from best CV-lambda 19.6 Summary", " 19 Lasso on ssta 19.1 LASSO model We fit a LASSO model on the precipitation and SST data. The precipitation target is the monthly mean precipitation in the Central Amazon Basin, the SST data are monthly temperatures over the globe. We use a 5-fold CV approach to find an optimal lambda. Each fold consists of 5 consecutive years of training data followed by 2 years of test data. In each fold we fit a LASSO model on a set of predetermined lambda values and choose the lambda that minimizes the MSE on the test set in that fold. After determining the best lambda in each fold we choose the lambda that minimizes the MSE over all folds and refit the model to the complete training data. Afterwards we evaluate the fitted model on a separate validation set with 5 years length which was not included in the training phase. 19.2 Error plots The plot shows the results from the 5 fold-CV plotted for each lambda. Lambda values start with high regularization and then decrease. Initially reducing regularization reduces the error until the 43th lambda value. As the errors get very large after the 60th lambda value and strictly increase we only showed the first 60 values for better visibility The highest regularization is chosen so that all coefficients are zero. In the above plot we can see the error curves for each fold. Folds 1,2 and 3 in the top row, left to right and folds 4 and 5 in the bottom row. We can see that initially that with decreasing regularization the MSE decreases as well. Up to a certain point after which the error rises again. Fold 4 seems to be the exception where a decrease in regularization does not increase the error dramatically as seen for example in folds 2 and 5 respectively. Below we can see the minimum MSE for each fold. ## [1] 723.3441 4240.6372 970.2217 739.9156 460.8825 And which lambda in the lambda vector resulted in the lowest prediction error on the folds´ test set. ## [1] 17 44 46 33 28 19.3 Coefficient plots The plots displays the nonzero coefficients in each fold computed for the lambda that minimizes the MSE on the test set in the respective fold. For all folds we see large negative coefficients in the arctic. The LASSO chooses among correlated variables only one and discards the others, which can be seen here since the variables chosen are scattered across the map and can but dont have to be close to each other. 19.4 Inspect predictions from each fold Following we inspect the folds precipitation time series and the predictions made by the model. In general the model fits the data sufficiently to predict the general form of the time series but misses some modes and is off in the larger values in fold 2. 19.5 Inspect predictions from best CV-lambda We choose now the best lambda with the 1SE rule and fit the model anew to predict the time series we held out as validation data Over the more than 5 years of validation data the model predicts the seasonal pattern of the precipitation time series quite well, but constantly fails to predict the higher values of precipitation. The MSE is 1215.74 and the RSME 34.87. 19.6 Summary We fitted a LASSO model for predicting the mean precipitation in the Central Amazon Basin and used a 5-fold blocked Cross Validation approach to find the optimal level of regularization. After training the model we evaluated its performance on a separate validation set that was not used in the training process. The model shows predicting capabilities but misses out on higher values of the precipitation target. Also although predicting seems to bring useful results, the choice of the LASSO coefficients seems somewhat arbitrary or at least not interpret able in a straightforward way. "],["references.html", "References", " References "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
