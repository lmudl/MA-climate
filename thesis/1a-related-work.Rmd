# Related work 

As already mentioned, the paper by @ciemer2020early, created an early warning
indicator for Amazon droughts using a complex network approach.
They used two datasets, one for the sea surface temperatures (@smith2008improvements) and one for
the precipitation (@funk2015climate) with monthly data for the time period of 1981 until 2016. The data can be downloaded for example in netcdf format and manipulated conveniently with Climate Data Operators (CDO, @schulzweida2019cdo). CDO in turn can be used with wrappers for R and Python. The data is organized on a longitude/latitude grid.  
They identified 4 oceanic regions that correlate the most with rain in the amazon basin by applying coupled networks.
Figure \@ref(fig:cross) shows the cross degree towards rainfall in the central Amazon basin (CAB, blue box), for positive and negative correlations. Darker shades indicate a larger cross degree, hence a larger number of links and correlations with rainfall at more grid points in the CAB.  
The correlations are measured using a spearman rank-order correlation coefficient.

\begin{equation}
 \rho = 1 - \frac{6\sum\Delta_{R_i}^2}{n(n^2-1)}  .
 (\#eq:spearman-rank)
\end{equation}

Where $\Delta_{R_i}$ denotes the difference between the ranks of observations of both variables at the same time $i$ and $n$ is the number of observations.
An adjacency matrix describes the resulting network, where the threshold $p_{th}$ was chosen so that only 10% of the strongest correlations are represented as links in the network

\begin{equation}
A_{ij} = \begin{cases}0 \textrm{ } p_{ij} < p_{th}\\ 1 \textrm{ } p_{ij}\geq p_{th}\\\end{cases}  .
(\#eq:adj-mat)
\end{equation}

The cross degree then gives the strength of correlation between a specific grid point $i$ of network $V_l$ (oceanic grid point) and another (sub)network $V_m$ (all grid points $j$ in central amazon basin)

\begin{equation}
k_{i}^{lm} = \sum\limits_{j \in V_m} A_{ij}, i \in V_l\  .
(\#eq:cross-deg)
\end{equation}

```{r cross, echo = FALSE, fig.align = 'center', out.width = '50%', fig.cap='"Cross degree between sea surface temperature and continental rainfall anomalies. For each sea surface temperature grid cell of the Atlantic and Pacific Ocean, the cross degree towards rainfall in the Central Amazon Basin (blue box) is shown, for a positive correlations and b negative correlations. Darker shading indicates a larger cross degree, implying a larger number of links, and thus significant correlations with rainfall at more grid points in the Central Amazon Basin. Red areas outline coherent oceanic regions with a the 20 highest cross degrees for positive correlations, found in the Southern Pacific Ocean (SPO) and Southern Tropical Atlantic Ocean (STAO), and b the 20 highest cross degrees for negative correlations, found in the Central Pacific Ocean (CPO) and Northern Tropical Atlantic Ocean (NTAO)" (Ciemer et al. (2020))'}
knitr::include_graphics("../figures/cross-degree.jpg")
```

They further explore the relationship by constructing (weighted) networks for sliding windows of 24 months between the Central Amazon Basin and each of the ocean regions. For each month except for the first two years, an individual network is computed based on the data of the previous 24 months.
Then they took the average of the cross correlations for each of the networks which gave a new time series of average cross correlation (ACC) values.
Each ACC summarizes the connectivity of one region with the CAB for the last 24 months.  
They found that NTAO and STAO gave the strongest signal, hence they applied the same sliding window coupled network approach between the ocean regions NTAO and STAO.
Before they computed networks between ocean and continental regions, now it is computed between these two Atlantic regions, NTAO and STAO.  
The resulting time series and its comparison to the drought index time series is shown in figure \@ref(fig:early) below.
They fund that using a ACC threshold for a drought (SPI below -1.5), lets them
forecast 6 of the 7 droughts in the observation period, missing the 2005 drought, while also giving one false alarm in 2002. 

```{r early, echo = FALSE, fig.align='center' ,out.width="75%", fig.cap='"Early-warning signal for droughts in the central Amazon basin. We compare the time evolution of the average cross correlation of the Northern Tropical Atlantic Ocean (NTAO) and Southern Tropical Atlantic Ocean (STAO), given by the blue curve, with the standardized precipitation index (SPI, orange) of the central Amazon basin. Orange dips indicate a negative SPI with a threshold for severely dry periods (SPI -1, dotted red line). We expect a drought event within the following one and a half years whenever the average cross correlation between NTAO and STAO SST anomalies falls below an empirically found threshold of -0.06. Green circles indicate a matching forecast based on the Atlantic SST correlation structure, with one false alarm in 2002 indicated by a grey circle, where the threshold is crossed but no drought took place in the direct aftermath (see Discussion). The temporal evolution of the average cross correlation shown here is smoothed using a Chebyshev type-I low-pass filter with a cutoff at 24 months" (Ciemer et al. (2020)).'}
knitr::include_graphics("../figures/early-warning-signals.jpg")
```


The work by @ciemer2020early shows potential forecasting capabilities and limitations.
While they were able to predict 5 out of 6 drought events, they also gave one false negative and one false positive result. Their work used a complex network approach that was applied stepwise (first two unweighted networks, then two weighted networks 
and in the end a dichotomous threshold decision rule). For the thesis we would like
to create a more general predictive model that can learn the relationship between the
SSTs and rainfall in the CAB. As already mentioned a first step will be a lasso model. First findings showed that, the classic lasso only chooses single points in the ocean as predictors, though. But our motivation is to discover predictive regions and not only single separated points.
Therefore in a next step make use of a generalized form of the LASSO that also takes into account that chosen predictors should be close to each other. This model is the so called fused lasso.  
For the models we also need a form of evaluation. Classic Cross Validation assumes independence of the observations. In our setting this is clearly violated due to the time dependency of the data.
We explore different possibilities to use an adjusted form of Cross Validation that takes this characteristic into account.  
<!-- Depending on how well the relationship between SST and rain can be established, we can take this a step further and use it as a so called "Emergent Constraint" (EC). -->
<!-- Since different climate models give different answers about future climate  -->
<!-- there is a need to narrow this "spread", which can be done by ECs. -->
<!-- To do so, we need a plausible relationship between a Variable X and Y (here: SST and drought).   -->
<!-- According to how well the relationship is represented in a climate model we  -->
<!-- assign "credibility" to a climate model's future projections  -->
<!-- (here: projections of future droughts in the Amazon rain forest).  -->
<!-- In summary this can be used to reduce uncertainty in the ensemble of  -->
<!-- climate models' future projections, f.e by using ML techniques as done by -->
<!-- @schlund2020constraining. -->
